function alertDiv(e,t){let s=document.createElement("template"),o=`\n    <div class="alert ${t}">\n        ${e}\n        <button type="button" \n                class="close" \n                data-dismiss="alert"\n                aria-label="Close">\n            <span aria-hidden="true">&times;</span>\n        </button>\n    </div>\n    `;return o=o.trim(),s.innerHTML=o,s.content.firstChild}async function castVote(e){let t={question_id:e.question_id.value,direction:e.direction.value,csrfmiddlewaretoken:e.csrfmiddlewaretoken.value};fetch(e.action,{method:"POST",headers:{"Content-Type":"application/json","X-CSRFToken":e.csrfmiddlewaretoken.value,Accept:"application/json","X-Requested-With":"XMLHttpRequest"},body:JSON.stringify(t)}).then(e=>e.json()).then(t=>{if(t.error)e.parent.insertBefore(alertDiv(t.error,"alert-danger"));else{let s=e.parentElement.parentElement,o=t.vote_state;1===o?(s.classList.remove("neutral"),s.classList.remove("downvoted"),s.classList.add("upvoted")):0===o?(s.classList.remove("upvoted"),s.classList.remove("downvoted"),s.classList.add("neutral")):-1===o&&(s.classList.remove("neutral"),s.classList.remove("upvoted"),s.classList.add("downvoted"))}})}const voteForms=document.getElementsByClassName("vote-form");for(let e of voteForms)e.addEventListener("submit",function(t){t.preventDefault(),castVote(e)});function load_vote_state(){if("undefined"==typeof vote_states)return null;for(const e in vote_states){let t=`question${e.slice(e.search(/\d+$/))}`,s=document.getElementById(t);if(s){let t=vote_states[e];1===t?(s.classList.remove("neutral"),s.classList.remove("downvoted"),s.classList.add("upvoted")):-1===t?(s.classList.remove("neutral"),s.classList.remove("upvoted"),s.classList.add("downvoted")):(s.classList.remove("upvoted"),s.classList.remove("downvoted"),s.classList.add("neutral"))}}}window.onload=load_vote_state;